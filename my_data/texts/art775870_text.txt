В этой статье на практических примерах рассмотрим какие задачи из коробки могут решать современные большие языковые модели (large language models, LLM).
Но сначала немного теории...
Что такое LLM?
Большая языковая модель — это тип модели глубокого обучения, которая понимает и генерирует текст на человеческом языке. Эти модели обучаются на огромных объемах текстовых данных (книги, статьи, сайты и др. источники) и содержат в себе большое число параметров.
Параметры — это переменные, присутствующие в модели, и которые изменяются в процессе обучения. Считается, что языковая модель является большой если содержит больше одного миллиарда параметров. Именно благодаря большому числу параметров LLM и способны распознавать, переводить, прогнозировать или генерировать текст или другой контент.
Обычно на вход таким моделям подается одно или несколько предложений. По которым модель пытается понять, что от нее хотят и генерирует ответ.
Под капотом у современных LLM‑моделей используется архитектура трансформер.
Подопытный кролик.
Эксперименты будем проводить на модели Mistral 7B LoRA . На лидерборде RussianSuperGLUE она сейчас на 18 месте. И по личному опыту, она лучше всех (из бесплатных) справляется с русскими текстами без дообучения.
Возможно для каких-то ваших специфических задач окажутся более подходящими другие модели.
Mistral 7B LoRA это модель дообученная (на русских текстах) методом LoRA на основе LLM Mistral. Чтобы задействовать ее нам понадобится следующие библиотеки:
Чтобы отправить запрос в Mistral 7B LoRA необходимо выполнить такой код:
Что здесь происходит подробно расписывать не буду (статья не об этом). Все что нужно знать: чтобы поменять запрос к LLM — нужно изменить переменную inp.
Задачи.
А теперь рассмотрим различные задачи, которые могут выполнять LLM.
Почти все приведенные здесь задачи LLM умеет выполнять из коробки. Без хардкорного дообучения. Для этого достаточно правильно сформулировать запрос. Причем чем «точнее» вы сформулируете запрос тем качественнее получите результат.
Генеративные задачи.
Генерация текста.
Самый простой и очевидный вариант использования. Можно попросить модель сгенерировать текст на любую тему: сочинить стихи, написать песню, рассказ или маркетинговый материал и многое другое.
Пример запроса:
Напиши короткий рассказ как я провел лето в деревне. В стиле Гарри Поттера.
Ответ:
Лето в деревне было невероятно интересным и захватывающим. Мы жили в старинном доме, который напоминал о древних времен магии. Каждый день мы проводили в разных местах деревни, исследуя тайные уголки и открывая новые секреты.
Однажды мы нашли старый заброшенный сад, полный странных растений и цветов. Некоторые из них были похожи на те, что мы видели в книгах о Гарри Поттере. Мы решили, что это могут быть магические растения, которые могут помочь нам найти новые способы использования магии.
В другой день мы обнаружили старый замок, который был запущен и заросший деревьями. Мы решили, что это может быть место, где когда‑то жили маги. Мы начали исследовать его, и нашли множество старых книг, записанных на языке магов.
Мы также нашли старый магический календарь, который помог нам понять, что лето — это время, когда магия становится особенно сильной. Мы решили, что это идеальное время для того, чтобы освоить новые заклинания и чары.
Каждый вечер мы собирались вместе и делились своими открытиями и знаниями. Мы научились создавать новые заклинания и чары, которые помогали нам в повседневной жизни. Например, мы научились создавать светильники из лучей солнца, которые помогали нам находить свой путь в темноте.
Когда лето закончилось, мы понимали, что наше лето в деревне было незабываемым и полным приключений. Мы вернулись домой, но с собой взяли много новых знаний и опыта, которые помогли нам стать более сильными и уверенными в себе.
И вот так, благодаря лету в деревне, мы стали магическими учениками, готовыми к новым приключениям и открытиям.
Чем больше контекста и больше деталей вы укажите в запросе, тем качественнее получите результат. Например, в этом запросе мы попросили сгенерировать текст в стиле Гарри Поттера.
Написание кода.
Вариация предыдущего пункта. Но настолько более важная/полезная, что под нее обучают отдельные LLM и создают целые сервисы (например, https://github.com/features/copilot ). Но писать код умеют и LLM общего назначения.
Пример запроса:
Напиши функцию Python для сортировки списка методом пузырьков.
Ответ:
Вот функция сортировки списка методом пузырька на языке Python:
def bubble_sort(input_list): # проверяем длину списка if len(input_list) <= 1: return input_list # перебираем все элементы списка for i in range(len(input_list)): # перебираем все элементы списка, начиная с текущего индекса for j in range(len(input_list) - i - 1): # если следующий элемент больше текущего, меняем их местами if input_list[j] > input_list[j + 1]: temp = input_list[j] input_list[j] = input_list[j + 1] input_list[j + 1] = temp return input_list Эта функция принимает список в качестве аргумента и возвращает отсортированный список.
Код может быть сгенерирован на разнообразных языках. Например, можно попросить написать SQL запрос и т.д. А чтобы улучшить запрос, укажите, что должна принимать функция, в каком виде формате и что должна возвращать и т.д.
З.Ы. Можете еще попробовать открытые модели специально натренированные на генерацию кода:
https://huggingface.co/bigcode/starcoder.
https://huggingface.co/stabilityai/stablecode-completion-alpha-3b-4k.
https://huggingface.co/codellama/CodeLlama-34b-Instruct-hf.
Существуют даже языковые модели натренированные под отдельные языки программирования:
SQL: https://huggingface.co/defog/sqlcoder2.
Мимикрия.
Можно попросить LLM играть какую-нибудь специфическую роль. Например:
Исполняй роль интерпретатора Python.
Выведи результат выполнения кода: ### print('Я супер интерпретатор') ###.
Ответ:
Я супер интерпретатор.
Вопрос-ответ.
Надоели гугл и яндекс? Спросите LLM :).
Пример запроса:
Сколько весит Луна?
Ответ:
Луна имеет средний диаметр около 3476 км (2159 миль) и массу около 7.34 × 10^22 кг (1.429 × 10^23 lb). Её гравитационное притяжение на поверхности Земли составляет примерно 1/6 от земного.
Вопрос, конечно же, можно задавать только на какие-то общие темы, которые модель видела во время обучения. Спрашивать ее про приватные данные вашей организации конечно же бесполезно (для этого нужно дообучать модель).
Чат (беседа).
Предыдущий вариант был обособленным. Т.е. каждый вопрос-ответ с т.з. модели существует сам по себе. Но с LLM можно вести осмысленный диалог (до определенной степени). Технически реализация диалога заключается в передаче всей предыдущей цепочки обсуждения вместе с новым сообщением. Шаблон в котором лучше всего подавать такую цепочку может отличатся для разных LLM.
Для Mistral 7B LoRA предложен такой шаблон:
Если с каждый запросом передавать предыдущую историю общения по такому шаблону, то можно получить примерно такой диалог:
Запрос:
Сколько весит луна?
Ответ:
Луна имеет средний диаметр около 3476 км (2159 миль) и массу около 7.34 × 10^22 кг (1.429 × 10^22 lb). Это примерно в 81-м раз меньше массы Земли.
Запрос:
А Марс?
Ответ:
Марс имеет средний диаметр около 6772 км (4212 миль) и массу около 6.39 × 10^23 кг (1.431 × 10^23 lb). Это примерно в 1/10 массы Земли.
Запрос:
А в фунтах?
Ответ:
Если вы хотите знать массу Луны или Марса в фунтах, то можно использовать следующие преобразования:
1 фунт = 0.453592 килограмма.
Масса Луны = 7.34 × 10^22 кг = 7.34 × 10^22 × 0.453592 фунта = 3.30 × 10^23 фунтов.
Масса Марса = 6.39 × 10^23 кг = 6.39 × 10^23 × 0.453592 фунта =  2.89 × 10^24 фунтов.
Таким образом, масса Луны составляет около 3.30 × 10^23 фунта, а масса Марса составляет около 2.89 × 10^24 фунта.
З.Ы. В карточке модели Mistral 7B LoRA предложен отличный класс для управления цепочкой вопрос-ответ.
Аналитические задачи.
Решение академических задач.
Создатели LLM не забывают и о школьниках :) LLM может решать и математические (и не только) задачи. Правда точность вычислений иногда оставляет желать лучшего. Поэтому ответ нужно перепроверять.
Пример запроса:
Из автобуса на остановке вышло 6 пассажиров, а вошло 11. На следующей остановке вышло 8, вошло 9. Сколько пассажиров стало в автобусе, если вначале в автобусе было 24 пассажира?
Ответ:
В начале в автобусе было 24 пассажира. Затем вышли 6 пассажиров и вошли 11 пассажиров, поэтому их количество увеличилось на 5 (11 - 6 = 5).
На следующей остановке вышли 8 пассажиров и вошли 9 пассажиров, поэтому их количество увеличено на 1 (9 - 8 = 1).
В итоге, количество пассажиров в автобусе стало равным 24 + 5 + 1 = 30.
З.Ы. Есть отдельные LLM, которые обучают под математические задачи: https://huggingface.co/EleutherAI/llemma_7b.
Классификация.
LLM могут и в классическое машинное обучение :).
Пример запроса:
Отзыв: "Я ненавижу этот фильм!" Какой это отзыв (положительный или отрицательный)?
Ответ:
Это отрицательный отзыв.
Обработка текста.
Перепиши текст.
Скомуниздили текст с просторов интернета и не знаете как безопасно вставить его в диплом? LLM вам поможет :).
Пример запроса:
Перепиши текст своими словами. ### Предметом эконометрики являются количественные закономерности между экономическими явлениями. Однако, в отличие от экономической теории, эконометрика делает упор на количественные, а не на качественные аспекты этих явлений. Например, известно, что спрос на товар с ростом его цены падает. Однако, как быстро и по какому закону это происходит, в экономической теории не определяется. Это в каждом конкретном случае делает эконометрика. С другой стороны, математическая экономика строит и анализирует модели экономических процессов без использования реальных числовых значений. Эконометрика же изучает модели на базе эмпирических данных. Наконец, в эконометрике широко используется аппарат математической статистики, особенно при установлении связей между экономическими показателями. В то же время в экономике невозможно проведение управляемого эксперимента, и эконометристы используют свои собственные приемы анализа, которые в математической статистике не встречаются. ###.
Ответ:
Эконометрика - это наука, которая изучает количественные закономерности между экономическими событиями. Она отличается от экономической теории тем, что она фокусируется на количественных, а не качественных аспектах этих событий. Например, если цена на товар растет, то спрос на этот товар обычно падает. Однако, сколько и как быстро это происходит, в экономической теории не описывается. Эконометрика же занимается изучением таких вопросов на основе реальных данных.
Математическая экономика, напротив, создает и анализирует модели экономических процессу без использования реальных чисел. Эконометрика же работает с реальными данными.
Кроме того, эконометрика активно использует методы математической статистики, особенно для исследования связей между экономическими показателями. В экономике невозможно провести контролируемый эксперимент, поэтому эконометристы используют свои собственные методы анализа, которые не встречаются в математической статистике.
Обратите внимание, что мы тут текст, над которым надо производить манипуляции, заключили в специальные символы. Модель так лучше понимает, с чем конкретно ей нужно работать.
Исправление ошибок.
И снова создатели LLM вспомнили о школьниках :) LLM могут искать и исправлять ошибки в тексте.
Пример запроса:
Исправь в тексте орфографические и пунктуационные ошибки. ### Ураган занес домек в страну необычайной красаты. Вокрук расстилался зеленый лес по краям росли деревья со спелыми плодами. ###.
Ответ:
Ураган занес домик в страну необычайной красоты. Вокруг расстилался зеленый лес по краям росли деревья со спелыми плодами.
Тут ошибки в трех словах (домек, красаты, Вокрук ) и отсутствует запятая во втором предложении (между "лес по"). Запятую LLM не нашла, а вот все орфографические ошибки исправила.
З.Ы. Такой результат мне удалось получить не сразу. Пришлось немного поиграться с параметрами:
Перевод.
Современные LLM обучаются на множестве языков, поэтому могут и в перевод.
Пример запроса:
Переведи на русский. ### The National Association for Stock Car Auto Racing, LLC (NASCAR) is an American auto racing sanctioning and operating company that is best known for stock car racing.[1] It is considered to be one of the top ranked motorsports organizations in the world, and is one of the largest spectator sports in America. The privately owned company was founded by Bill France Sr. in 1948,[2] and his son, Jim France, has been the CEO since August 2018.[3] The company is headquartered in Daytona Beach, Florida.[4] Each year, NASCAR sanctions over 1,500 races at over 100 tracks in 48 US states as well as in Canada, Mexico, Brazil and Europe. ###.
Ответ:
Американская компания по проведению автомобильных гонок NASCAR (National Association for Stock Car Auto Racing, LLC) является одним из ведущих мировых моторных спортивных организаций и одним из самых популярных видов зрительских мероприятий в США. Она была основана Биллом Франсом-старшим в 1948 году и с тех пор стала известной прежде всего благодаря гонкам на автомобилях типа "stock car". В настоящее время компания возглавляется сыном основателя, Джимом Франсом, который занимает должность генерального директора с августа 2018 года. Головной офис NASCAR расположен в городе Дайтон-Бич, штат Флорида. Каждый год NASCAR проводит более 1500 гонок на более чем 100 трассах в 48 штатах США, а также в Канаде, Мексике, Бразилии и Европе.
Чтобы улучшить запрос укажите исходный и целевой язык перевода. Также можете указать, в каком тоне должен быть перевод, или укажите какой-то жаргон и т.д.
Суммаризация.
Можно сократить исходный текст до каких-то удобоваримых размеров.
Пример запроса:
Сократи текст до одного предложения. ### Вопрос, был ли тирекс охотником или падальщиком, до сих пор не решён. Но набор прогрессивных черт тираннозавра всё больше склоняет палеонтологов к охотничьему образу жизни. Рекс – обладатель хорошо развитого бинокулярного зрения. Бинокулярное зрение – способность фокусироваться на объекте обоими глазами, что даёт более точную оценку расстояния. Такое зрение более свойственно активным охотникам, нежели падальщикам. Отдел мозга тираннозавра, отвечающий за обоняние, также хорошо развит. Можно сослаться, что это свойственно падальщикам, но хорошее обоняние есть у всех плотоядных: как любителей падали, так и превосходных охотников. Также, тираннозавр — обладатель укреплённой челюсти и глубоко посаженных зубов. Что примечательно, челюсть имеет дополнительную подвижность, относительно других тиранозаврид, что обеспечивает повышенную устойчивость при боковых нагрузках. Такая адаптация тоже больше подходит охотнику на крупных животных, нежели падальщику, чья еда не сопротивляется и не может повредить челюсть. Челюсти и зубы тираннозавра будто специально созданы для удержания сопротивляющейся многотонной жертвы. Тираннозавр со своим весом, конечно же, не мог бегать за жертвой, что подтверждают свежие исследования, но выслеживать был вполне в состоянии. Правда тираннозавру и незачем было бегать: его основной рацион – медленные трицератопсы и гадрозавры с углом разворота как у поезда. Об этом свидетельствуют прижизненные следы укусов гигантских челюстей на воротниках и хвостах жертв. ###.
Ответ:
Тираннозавр обладает хорошим бинокулярным зрением, хорошо развитым обонянием и укреплённой челюстью, что говорит о том, что он был активным охотником.
Поиск информации.
LLM могут производить поиск и по каким-то приватным источникам.
Пример запроса:
Найди в тексте, из чего состоит система экранных представлений? ### Система экранных представлений AutoCAD MEP управляет тем, как выглядят объекты в видовом экране. Задавая подлежащие отображению объекты и направление, в котором их нужно рассматривать, можно вывести на экран различные отображения, такие как планы, 3D модели, схемы стояков в изометрии и принципиальные схемы. Установка стандартных экранных представлений позволяет сохранить согласованность нескольких чертежей. Система экранных представлений AutoCAD MEP состоит из трех основных компонентов: - Экранные представления на стр. 228 для управления способом отображения отдельных объектов - Наборы экранных представлений на стр. 231 для группирования экранных представлений объектов - Конфигурации экранных представлений на стр. 232 для связывания наборов экранных представлений и направлений взгляда Эти компоненты имеют иерархическую природу. Каждая конфигурация экранных представлений содержит наборы экранных представлений, а каждый набор экранных представлений содержит экранные представления. Сочетание этих компонентов создает систему экранных представлений: ###.
Ответ:
В тесте указано, что система экранных представлений AutoCAD MEP содержит три основных компонента: - Экранные представления - Наборы экранных представлений - Конфигурации экранных представлений.
Это наверное не самый полезный пример. Будет больше пользы от поиска по какой-либо базе данных или какому-нибудь документу. Для этого нужно строить хитрые пайплайны. А чтобы этого не делать ручками можно воспользоваться готовыми библиотеками. Например, LangChain или LlamaIndex.
Для LangChain код будет выглядеть примерно так:
Здесь мы искали ответ в вордовском файле, но список поддерживаемых источников гораздо шире: это могут и ваши базы данных, и PDF файлы и даже веб-страницы, оперативно подгружаемые из интернета.
Извлечение структурированной информации.
Частный случай предыдущего варианта. Информацию можно не просто искать, но и сразу отображать в каком-то структурированном виде. Например, таким образом можно обработать объявления с Авито, чтобы вытащить полезную информацию.
Пример запроса:
Извлеки из объявления площадь участка и его стоимость. Формат вывода: ### Площадь: 10 соток Стоимость: 10 000 рублей ### Объявление: ### Земельный участок площадью 955 кв.м., расположен в районе Седанки: г. Владивосток, в районе ул. Скатная, д. 40д. Участок обладает отличной транспортной доступностью и инвестиционной привлекательностью. В непосредственной близости находится торговый центр "Седанка Сити". Преимуществом такого расположения является экологически чистый район и минимальное удаление от города Владивостока. В 5-ти минутах езды остановка "Дом ветеранов". 10 минут езды до "Владивостокской международной средней общеобразовательной школы", детского сада "Василёк", "Маленький волшебник", "Вершина Монтессори". В 10-ти минутах езды "Станция Седанка". Земельный участок находится в границах населенного пункта (город Владивосток), что позволяет возводить объект капитального строительства (индивидуальный жилой дом с возможностью прописки). Участок не затапливаемый. Полный пакет документов. Имеется возможность изменения адреса земельного участка. Отсутствуют агентские и иные платежи. Земельный участок предоставлен в аренду сроком на 20 лет. Сумма арендной платы за полный год составляет 4.500 руб. При переуступке права аренды, стоимость арендных платежей не изменяется. Стоимость выкупа земельного участка в собственность - 5% от кадастровой стоимости = 75.208 руб. Плата за договор переуступки права аренды и иные документы отсутствует. ###.
Ответ:
Площадь: 955 кв.м. Стоимость: 75 208 рублей.
Вместо заключения.
Это далеко не полный перечень задач, которые можно решать с помощью LLM. Можно придумать еще много чего интересного. Конечно ответы которые дает LLM не всегда идеальны и порой их нужно подправлять. Также можно экспериментировать с запросом,  меняя его формулировку, чтобы добиться нужного качества.
Еще больше можно добиться от LLM дообучив ее. Но это уже совсем другая статья… не переключайтесь :).
---------------------.
З.Ы. Если найду или придумаю другие способы применения LLM буду их дописывать в статье. А если у вас есть интересные практические примеры использования LLM — пишите их в комментариях :).
---------------------.
Мой телеграм-канал.
